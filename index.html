<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ—¥æœ¬ä¹‹æ—…åŠ©æ‰‹</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- LINE LIFF SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2A9D8F', // Lake Green
                        'primary-dark': '#21867a',
                        'primary-light': '#E0F2F1',
                        bg: '#FAFAF9', // Stone-50
                    },
                    fontFamily: {
                        sans: ['Noto Sans TC', 'sans-serif'],
                        serif: ['Noto Serif JP', 'serif'],
                    },
                    spacing: {
                        'safe-top': 'env(safe-area-inset-top)',
                        'safe-bottom': 'env(safe-area-inset-bottom)',
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        h1, h2, h3, .japanese-font {
            font-family: 'Noto Serif JP', serif;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .timeline-line {
            position: absolute;
            left: 5rem;
            top: 2rem;
            bottom: -1rem;
            width: 1px;
            background-color: #E7E5E4;
            z-index: 0;
            border-left: 1px dashed #E7E5E4;
            background: none;
        }
        .glass-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-top: 1px solid rgba(0,0,0,0.03);
            box-shadow: 0 -4px 20px rgba(0,0,0,0.02);
        }
        .custom-input {
            background-color: #F5F5F4;
            border: 1px solid transparent;
            transition: all 0.3s ease;
        }
        .custom-input:focus {
            background-color: white;
            border-color: #2A9D8F;
            box-shadow: 0 0 0 3px rgba(42, 157, 143, 0.1);
        }
        
        .slide-up-enter-active, .slide-up-leave-active {
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .slide-up-enter-from, .slide-up-leave-to {
            transform: translateY(100%);
        }
        
        #app {
            -webkit-overflow-scrolling: touch;
        }
    </style>
</head>
<body class="text-stone-700 h-screen w-screen overflow-hidden bg-gray-200 flex items-center justify-center sm:py-8">

<!-- Phone Container Simulator -->
<div id="app" class="w-full h-full sm:max-w-[414px] sm:h-[850px] sm:max-h-[90vh] bg-bg relative flex flex-col sm:rounded-[40px] sm:shadow-2xl sm:border-[8px] sm:border-stone-800 overflow-hidden ring-1 ring-stone-900/5 transition-all duration-300">

    <!-- Top Header -->
    <header class="bg-white pt-10 pb-4 px-6 flex justify-between items-end z-20 border-b border-stone-100 flex-shrink-0">
        <div class="flex-1 mr-2 overflow-hidden">
            <div class="flex items-center">
                <h1 class="text-2xl font-bold text-stone-800 tracking-wide flex-1 overflow-hidden">
                    <!-- Editable Title -->
                    <input 
                        v-if="!isReadOnly"
                        type="text" 
                        v-model="tripTitle" 
                        @blur="saveData"
                        class="bg-transparent outline-none w-full border-b border-transparent focus:border-primary/50 transition-all p-0 m-0 japanese-font text-stone-800 placeholder-stone-300 truncate" 
                        placeholder="è¼¸å…¥æ—…ç¨‹åç¨±"
                    >
                    <!-- Read-Only Title -->
                    <span v-else class="w-full p-0 m-0 japanese-font text-stone-800 truncate block">
                        {{ tripTitle }}
                    </span>
                </h1>
                
                <!-- Auth Actions (Visible ONLY if Read-Only) -->
                <div v-if="isReadOnly" class="ml-2">
                    <!-- Manual Unlock Button -->
                    <button @click="manualUnlock" class="text-stone-300 hover:text-stone-500 p-1">
                        <i class="fa-solid fa-lock text-sm"></i>
                    </button>
                </div>
            </div>
            
            <!-- Date Display -->
            <p class="text-stone-400 text-xs mt-1 font-sans tracking-wider flex items-center">
                <i class="fa-regular fa-calendar mr-1.5 opacity-70"></i>
                <span v-if="startDate">{{ getDateDisplay(0, true).split(' ')[0] }} å‡ºç™¼</span>
                <span v-else>è¨­å®šå‡ºç™¼æ—¥æœŸ</span>
            </p>
        </div>
        
        <!-- Settings Button (Hidden if Read-Only) -->
        <div v-if="!isReadOnly" class="bg-stone-50 p-2 rounded-full cursor-pointer hover:bg-stone-200 transition text-stone-400 active:scale-90 flex-shrink-0" @click="showSettingsModal = true">
            <i class="fa-solid fa-gear"></i>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto no-scrollbar pb-36 relative bg-bg scroll-smooth">
        
        <!-- View: Itinerary -->
        <div v-if="currentView === 'itinerary'" class="p-4 min-h-full">
            
            <!-- Date Selector -->
            <div class="sticky top-0 bg-bg/95 backdrop-blur-md z-20 py-2 -mx-4 px-4 border-b border-stone-100/50 mb-4 transition-all duration-300">
                <div class="flex overflow-x-auto no-scrollbar space-x-3 pb-2 pt-1 px-1">
                    <button 
                        v-for="(day, index) in days" 
                        :key="index"
                        @click="activeDayIndex = index"
                        class="flex-shrink-0 flex flex-col items-center justify-center w-20 h-16 rounded-2xl transition-all duration-300 relative overflow-hidden active:scale-95"
                        :class="activeDayIndex === index ? 'bg-primary text-white shadow-lg shadow-primary/30 scale-105' : 'bg-white text-stone-400 border border-stone-100'">
                        <span class="text-xs opacity-80 uppercase font-sans tracking-wider font-bold">Day {{ index + 1 }}</span>
                        <span class="text-xl font-serif font-bold leading-none mt-0.5">{{ getDateDisplay(index) }}</span>
                    </button>
                    
                    <!-- Add Day Button (Hidden if Read-Only) -->
                    <button v-if="!isReadOnly" @click="addDay" class="flex-shrink-0 w-16 h-16 rounded-2xl border border-dashed border-primary/40 text-primary flex items-center justify-center hover:bg-primary-light transition active:scale-95">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>
            </div>

            <!-- Weather Widget -->
            <div class="mb-6 mx-1">
                <div class="bg-gradient-to-r from-sky-100 to-white p-4 rounded-2xl border border-sky-100 shadow-sm flex justify-between items-center relative overflow-hidden">
                    <div class="absolute -right-6 -top-6 w-24 h-24 bg-sky-200/20 rounded-full blur-xl"></div>
                    
                    <div class="flex items-center z-10">
                        <div class="mr-3 text-sky-500 text-2xl w-10 text-center">
                            <i v-if="loadingWeather" class="fa-solid fa-spinner fa-spin text-sky-400"></i>
                            <span v-else-if="currentDayData.weather">{{ getWeatherIcon(currentDayData.weather.code) }}</span>
                            <i v-else class="fa-solid fa-cloud-sun text-sky-200"></i>
                        </div>
                        <div>
                            <div class="flex items-center">
                                <h3 class="font-bold text-stone-700 text-lg mr-2 font-serif">
                                    {{ currentDayData.city || 'è‡ªå‹•åµæ¸¬åœ°é»...' }}
                                </h3>
                                <!-- City Edit Button (Hidden if Read-Only) -->
                                <button v-if="!isReadOnly" @click="setCityForDay" class="text-stone-300 hover:text-sky-500 transition text-xs">
                                    <i class="fa-solid fa-pen"></i>
                                </button>
                            </div>
                            <p v-if="loadingWeather" class="text-xs text-sky-500 mt-0.5 animate-pulse">æ­£åœ¨æ›´æ–°å¤©æ°£è³‡è¨Š...</p>
                            <p v-else-if="currentDayData.weather" class="text-xs text-stone-500 mt-0.5 font-sans">
                                <span class="font-bold text-sky-600 text-sm mr-1">{{ currentDayData.weather.temp }}Â°C</span> 
                                <span>{{ getWeatherDescription(currentDayData.weather.code) }}</span>
                            </p>
                            <p class="text-[10px] text-stone-400 mt-0.5" v-else>åŠ å…¥è¡Œç¨‹å¾Œå°‡è‡ªå‹•é¡¯ç¤ºå¤©æ°£</p>
                        </div>
                    </div>
                    
                    <button v-if="currentDayData.city && !loadingWeather" @click="fetchWeatherForDay(activeDayIndex)" class="text-xs bg-white text-sky-500 px-3 py-1.5 rounded-full border border-sky-100 shadow-sm hover:bg-sky-50 transition z-10 active:scale-95">
                        <i class="fa-solid fa-rotate-right mr-1"></i> æ›´æ–°
                    </button>
                </div>
            </div>

            <!-- Empty State -->
            <div v-if="currentDayEvents.length === 0" class="flex flex-col items-center justify-center mt-10 text-stone-300 animate-[fadeIn_0.5s_ease-out]">
                <div class="w-24 h-24 rounded-full bg-white border border-dashed border-stone-200 flex items-center justify-center mb-6">
                    <i class="fa-regular fa-map text-3xl text-stone-200"></i>
                </div>
                <p class="font-serif text-lg text-stone-500">å°šæœªå®‰æ’è¡Œç¨‹</p>
                <p class="text-xs mt-2 font-sans">{{ getDateDisplay(activeDayIndex, true) }}</p>
                <!-- Add Button (Hidden if Read-Only) -->
                <button v-if="!isReadOnly" @click="openEventModal()" class="mt-8 px-8 py-3 bg-primary text-white rounded-full shadow-lg hover:bg-primary-dark transition font-medium tracking-wide active:scale-95">
                    æ–°å¢è¡Œç¨‹
                </button>
            </div>

            <!-- Timeline -->
            <div v-else class="space-y-6 relative mt-2 pb-10">
                <div v-for="(event, index) in currentDayEvents" :key="event.id" class="relative pl-24 group animate-[fadeIn_0.3s_ease-out]" :style="{ animationDelay: `${index * 0.05}s` }">
                    <div class="timeline-line" v-if="index !== currentDayEvents.length - 1"></div>
                    <div class="absolute left-0 top-0.5 w-16 text-xl font-bold text-stone-700 text-right pr-2 font-mono">{{ event.time }}</div>
                    <div class="absolute left-[4.25rem] top-1.5 w-6 h-6 rounded-full border-2 border-white shadow-sm z-10 flex items-center justify-center text-[10px]" :class="getEventColor(event.type)">
                        <i :class="getEventIcon(event.type)"></i>
                    </div>

                    <div :class="['p-5 rounded-2xl shadow-[0_4px_20px_-10px_rgba(0,0,0,0.08)] border active:scale-[0.98] transition-transform duration-200', event.type === 'flight' ? 'bg-indigo-50 border-indigo-200' : 'bg-white border-stone-50']">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h3 class="font-bold text-stone-800 text-lg japanese-font leading-tight">
                                    {{ event.location }}
                                    <span v-if="event.type === 'flight' && event.flightNumber" class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-white text-indigo-600 font-mono border border-indigo-100 shadow-sm">
                                        <i class="fa-solid fa-ticket mr-1"></i>{{ event.flightNumber }}
                                    </span>
                                </h3>
                            </div>
                            
                            <!-- Edit/Delete Buttons (Hidden if Read-Only) -->
                            <div v-if="!isReadOnly" class="flex flex-col space-y-2 ml-2">
                                <button @click="openEventModal(event)" :class="event.type === 'flight' ? 'bg-white text-indigo-400 hover:text-indigo-600' : 'bg-stone-50 text-stone-300 hover:text-primary'" class="w-8 h-8 rounded-full flex items-center justify-center transition shadow-sm">
                                    <i class="fa-solid fa-pen text-xs"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="mt-4 flex gap-2">
                            <a v-if="event.location" :href="getMapUrl(event.location)" target="_blank" :class="event.type === 'flight' ? 'bg-white text-indigo-600 hover:bg-indigo-50 border-indigo-100' : 'bg-stone-50 text-stone-600 hover:bg-stone-100'" class="flex-1 text-sm py-2.5 rounded-xl text-center transition font-bold active:bg-stone-200 shadow-sm">
                                <i class="fa-solid fa-location-arrow mr-1.5" :class="event.type === 'flight' ? 'text-indigo-500' : 'text-primary'"></i> å°èˆª
                            </a>
                            <!-- Delete Button (Hidden if Read-Only) -->
                            <button v-if="!isReadOnly" @click="deleteEvent(event.id)" :class="event.type === 'flight' ? 'bg-white text-indigo-300 hover:text-red-400' : 'bg-stone-50 text-stone-400 hover:text-red-400'" class="px-3 rounded-xl transition active:scale-90 shadow-sm">
                                <i class="fa-solid fa-trash text-xs"></i>
                            </button>
                        </div>
                        
                        <div v-if="event.note" class="mt-3 pt-3 border-t text-xs leading-relaxed" :class="event.type === 'flight' ? 'border-indigo-200 text-indigo-800' : 'border-stone-100 text-stone-500'">
                            <i class="fa-regular fa-comment-dots mr-1.5 opacity-50"></i>
                            {{ event.note }}
                        </div>
                    </div>
                </div>

                <!-- Add Button at bottom of list (Hidden if Read-Only) -->
                <div v-if="!isReadOnly" class="flex justify-center pt-4">
                     <button @click="openEventModal()" class="group flex items-center space-x-2 text-primary text-sm font-medium bg-white px-5 py-2.5 rounded-full shadow-sm border border-primary/20 hover:bg-primary-light transition active:scale-95">
                        <i class="fa-solid fa-plus group-hover:rotate-90 transition-transform"></i>
                        <span>åŠ å…¥ä¸‹ä¸€å€‹è¡Œç¨‹</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- View: Converter (Always Visible, Local Tool) -->
        <div v-if="currentView === 'converter'" class="p-6 h-full flex flex-col items-center">
            <div class="w-full bg-white rounded-2xl p-4 shadow-sm border border-stone-100 mb-6 flex justify-between items-center animate-[slideUp_0.3s_ease-out]">
                <label class="text-xs font-bold text-stone-400 uppercase tracking-wider">ç•¶å‰åŒ¯ç‡ (JPY/TWD)</label>
                <div class="flex items-center">
                    <span class="text-stone-400 mr-2 text-sm font-mono">1 JPY =</span>
                    <input type="number" v-model.number="exchangeRate" @input="calculate('jpy')" step="0.001" class="w-20 bg-stone-50 rounded-lg px-2 py-1 text-right font-mono font-bold text-stone-700 outline-none focus:ring-2 focus:ring-primary/50 transition-all">
                    <span class="text-stone-400 ml-1 text-sm font-bold">å°å¹£</span>
                </div>
            </div>
            <!-- Converter UI (Same as before) -->
            <div class="w-full bg-white rounded-3xl shadow-xl shadow-stone-200/50 p-6 border border-white space-y-6 animate-[fadeIn_0.5s_ease-out_0.1s_both]">
                <div>
                    <label class="block text-xs font-bold text-stone-400 mb-2 flex items-center"><span class="bg-stone-100 text-stone-500 w-6 h-6 rounded-full flex items-center justify-center mr-2 text-[10px]">æ—¥</span>æ—¥åœ“ (JPY)</label>
                    <div class="relative"><input type="number" v-model.number="calcJpy" @input="calculate('jpy')" placeholder="0" class="w-full bg-stone-50 rounded-2xl px-5 py-4 text-3xl font-mono font-bold text-stone-800 outline-none focus:ring-2 focus:ring-primary/20 transition-all"><span v-if="calcJpy" @click="calcJpy = ''; calculate('jpy')" class="absolute right-4 top-1/2 -translate-y-1/2 text-stone-300 bg-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer shadow-sm active:scale-90 transition"><i class="fa-solid fa-times text-xs"></i></span></div>
                </div>
                <div class="flex justify-center -my-2 relative z-10"><div class="bg-stone-100 p-2 rounded-full border-4 border-white text-stone-400"><i class="fa-solid fa-arrow-down-up text-xs"></i></div></div>
                <div>
                    <label class="block text-xs font-bold text-stone-400 mb-2 flex items-center"><span class="bg-primary/10 text-primary w-6 h-6 rounded-full flex items-center justify-center mr-2 text-[10px]">å°</span>å°å¹£ (TWD)</label>
                    <div class="relative"><input type="number" v-model.number="calcTwd" @input="calculate('twd')" placeholder="0" class="w-full bg-primary/5 rounded-2xl px-5 py-4 text-3xl font-mono font-bold text-primary outline-none focus:ring-2 focus:ring-primary/20 transition-all"><span v-if="calcTwd" @click="calcTwd = ''; calculate('twd')" class="absolute right-4 top-1/2 -translate-y-1/2 text-primary/30 bg-white rounded-full w-6 h-6 flex items-center justify-center cursor-pointer shadow-sm active:scale-90 transition"><i class="fa-solid fa-times text-xs"></i></span></div>
                </div>
            </div>
            <div class="w-full grid grid-cols-4 gap-3 mt-6 animate-[fadeIn_0.5s_ease-out_0.2s_both]">
                <button v-for="amount in [1000, 2000, 5000, 10000]" :key="amount" @click="setJpy(amount)" class="bg-white rounded-xl py-3 text-xs font-bold text-stone-500 shadow-sm border border-stone-100 hover:bg-primary hover:text-white hover:border-primary active:scale-95 transition font-mono">Â¥{{ amount.toLocaleString() }}</button>
            </div>
        </div>

        <!-- View: Translation (Always Visible) -->
        <div v-if="currentView === 'translation'" class="p-6 h-full flex flex-col justify-center items-center pb-32">
            <div class="text-center mb-10 animate-[slideUp_0.5s_ease-out]">
                <div class="w-24 h-24 bg-white rounded-full flex items-center justify-center mx-auto mb-6 text-primary shadow-xl shadow-stone-100 ring-4 ring-stone-50"><span class="text-4xl font-serif">ã‚</span></div>
                <h2 class="text-2xl font-bold text-stone-800 font-serif">ä¸­æ—¥ç¿»è­¯åŠ©æ‰‹</h2>
                <p class="text-stone-400 mt-2 text-sm">é€£çµ Google ç¿»è­¯ï¼Œè¼•é¬†å°è©±</p>
            </div>
            <div class="w-full bg-white rounded-3xl shadow-xl shadow-stone-200/50 p-6 border border-white animate-[fadeIn_0.5s_ease-out_0.2s_both]">
                <form action="https://translate.google.com/" method="GET" target="_blank">
                    <input type="hidden" name="sl" value="zh-TW"><input type="hidden" name="tl" value="ja"><input type="hidden" name="op" value="translate">
                    <div class="mb-5">
                        <label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wide">è¼¸å…¥ä¸­æ–‡</label>
                        <div class="relative"><textarea name="text" v-model="translationText" rows="3" placeholder="ä½ å¥½ï¼Œè«‹å•..." class="custom-input w-full rounded-2xl px-5 py-4 text-stone-700 resize-none placeholder-stone-300 text-base"></textarea></div>
                    </div>
                    <button type="submit" class="w-full bg-primary text-white font-bold py-4 rounded-2xl shadow-lg shadow-primary/30 hover:bg-primary-dark active:scale-95 transition flex items-center justify-center text-lg" :class="{'opacity-50 cursor-not-allowed': !translationText}" :disabled="!translationText"><span>ç¿»è­¯æˆæ—¥æ–‡</span><i class="fa-solid fa-arrow-right ml-2 text-sm"></i></button>
                </form>
                <div class="relative flex py-4 items-center"><div class="flex-grow border-t border-stone-100"></div><span class="flex-shrink-0 mx-4 text-stone-300 text-[10px] font-sans">OR</span><div class="flex-grow border-t border-stone-100"></div></div>
                <a href="https://translate.google.com/?sl=zh-TW&tl=ja&op=images" target="_blank" class="w-full bg-stone-50 text-stone-600 font-bold py-4 rounded-2xl hover:bg-stone-100 active:scale-95 transition flex items-center justify-center no-underline"><i class="fa-solid fa-camera mr-2 text-primary"></i> æ‹ç…§ç¿»è­¯</a>
            </div>
        </div>

    </main>

    <!-- Floating Action Button (Hidden if Read-Only) -->
    <div v-if="!isReadOnly" class="absolute bottom-24 left-1/2 -translate-x-1/2 z-40">
        <button @click="quickAction" class="bg-primary text-white w-14 h-14 rounded-full shadow-lg shadow-primary/40 flex items-center justify-center transform active:scale-90 transition duration-300 hover:scale-105">
            <i class="fa-solid fa-plus text-xl"></i>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="glass-nav absolute bottom-0 w-full pb-safe pt-2 px-6 flex justify-between items-center h-[80px] z-30 rounded-t-[30px] sm:rounded-b-[32px]">
        <button @click="currentView = 'itinerary'" :class="['flex flex-col items-center space-y-1 transition-all duration-300 w-16 active:scale-90', currentView === 'itinerary' ? 'text-primary -translate-y-1' : 'text-stone-300 hover:text-stone-500']">
            <i class="fa-solid fa-map text-xl"></i><span class="text-[10px] font-medium tracking-wide">è¡Œç¨‹</span>
        </button>
        <button @click="currentView = 'converter'" :class="['flex flex-col items-center space-y-1 transition-all duration-300 w-16 active:scale-90', currentView === 'converter' ? 'text-primary -translate-y-1' : 'text-stone-300 hover:text-stone-500']">
            <i class="fa-solid fa-money-bill-transfer text-2xl"></i><span class="text-[10px] font-medium tracking-wide">åŒ¯ç‡</span>
        </button>
        <button @click="currentView = 'translation'" :class="['flex flex-col items-center space-y-1 transition-all duration-300 w-16 active:scale-90', currentView === 'translation' ? 'text-primary -translate-y-1' : 'text-stone-300 hover:text-stone-500']">
            <i class="fa-solid fa-language text-xl"></i><span class="text-[10px] font-medium tracking-wide">ç¿»è­¯</span>
        </button>
    </nav>

    <!-- Modal: Trip Settings -->
    <transition name="slide-up">
    <div v-if="showSettingsModal" class="absolute inset-0 bg-stone-900/40 backdrop-blur-sm z-50 flex items-end justify-center sm:rounded-[32px] overflow-hidden" @click.self="showSettingsModal = false">
        <div class="bg-white w-full rounded-t-3xl p-8 transform transition-all flex flex-col shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-stone-800 font-serif">æ—…ç¨‹è¨­å®š</h3>
                <button @click="showSettingsModal = false" class="w-10 h-10 rounded-full bg-stone-50 text-stone-400 flex items-center justify-center hover:bg-stone-100 transition active:scale-90"><i class="fa-solid fa-times text-lg"></i></button>
            </div>
            <div class="space-y-6">
                <div><label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider">å‡ºç™¼æ—¥æœŸ</label><input type="date" v-model="startDate" class="custom-input w-full rounded-2xl px-5 py-4 text-lg font-medium outline-none text-stone-800"></div>
                <div>
                    <label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider">æ—…éŠå¤©æ•¸</label>
                    <div class="flex items-center space-x-4"><button @click="changeDuration(-1)" class="w-12 h-12 rounded-xl bg-stone-100 text-stone-500 flex items-center justify-center hover:bg-stone-200 active:scale-90 transition"><i class="fa-solid fa-minus"></i></button><div class="flex-1 text-center font-mono text-2xl font-bold text-stone-800">{{ days.length }} å¤©</div><button @click="changeDuration(1)" class="w-12 h-12 rounded-xl bg-primary/10 text-primary flex items-center justify-center hover:bg-primary/20 active:scale-90 transition"><i class="fa-solid fa-plus"></i></button></div>
                </div>
                <div>
                    <label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider">äººæ•¸</label>
                    <div class="flex items-center space-x-4"><button @click="changeTravelerCount(-1)" class="w-12 h-12 rounded-xl bg-stone-100 text-stone-500 flex items-center justify-center hover:bg-stone-200 active:scale-90 transition"><i class="fa-solid fa-minus"></i></button><div class="flex-1 text-center font-mono text-2xl font-bold text-stone-800">{{ travelers.length }} äºº</div><button @click="changeTravelerCount(1)" class="w-12 h-12 rounded-xl bg-primary/10 text-primary flex items-center justify-center hover:bg-primary/20 active:scale-90 transition"><i class="fa-solid fa-plus"></i></button></div>
                    <p class="text-[10px] text-stone-400 mt-2 text-center">äººæ•¸è®Šå‹•æœƒè‡ªå‹•èª¿æ•´åˆ†å¸³åå–®</p>
                </div>
                <div class="pt-4"><button @click="saveTripSettings" class="w-full bg-primary text-white font-bold py-4 rounded-2xl shadow-lg shadow-primary/20 hover:bg-primary-dark active:scale-95 transition text-lg">å„²å­˜è¨­å®š</button></div>
            </div>
        </div>
    </div>
    </transition>

    <!-- Modal: Add/Edit Event -->
    <transition name="slide-up">
    <div v-if="showEventModal && eventForm" class="absolute inset-0 bg-stone-900/40 backdrop-blur-sm z-50 flex items-end justify-center sm:rounded-[32px] overflow-hidden" @click.self="showEventModal = false">
        <div class="bg-white w-full h-[85%] rounded-t-3xl p-8 transform transition-all flex flex-col shadow-2xl">
            <div class="flex justify-between items-center mb-6 flex-shrink-0">
                <h3 class="text-2xl font-bold text-stone-800 font-serif">{{ editingEventId ? 'ç·¨è¼¯è¡Œç¨‹' : 'æ–°å¢è¡Œç¨‹' }}</h3>
                <button @click="showEventModal = false" class="w-10 h-10 rounded-full bg-stone-50 text-stone-400 flex items-center justify-center hover:bg-stone-100 transition active:scale-90"><i class="fa-solid fa-times text-lg"></i></button>
            </div>
            
            <div class="space-y-5 overflow-y-auto pb-safe flex-1 no-scrollbar">
                <div>
                    <label class="block text-xs font-bold text-stone-400 mb-3 uppercase tracking-wider">é¡å‹</label>
                    <div class="flex space-x-4 overflow-x-auto no-scrollbar pb-1">
                        <button v-for="type in eventTypes" :key="type.value" @click="eventForm.type = type.value" :class="['flex-shrink-0 flex flex-col items-center justify-center w-16 h-16 rounded-2xl border transition-all duration-200', eventForm.type === type.value ? 'bg-stone-800 text-white border-stone-800 shadow-md transform scale-105' : 'bg-white text-stone-400 border-stone-200 hover:border-stone-300']">
                            <i :class="[type.icon, 'text-lg mb-1']"></i><span class="text-[10px] font-medium">{{ type.label }}</span>
                        </button>
                    </div>
                </div>
                <div><label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider">æ™‚é–“</label><input type="time" v-model="eventForm.time" class="custom-input w-full rounded-2xl px-5 py-4 text-xl font-mono font-medium outline-none"></div>
                <div v-if="eventForm.type === 'flight'" class="animate-[fadeIn_0.3s_ease-out]">
                    <label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider">èˆªç­ä»£è™Ÿ</label>
                    <div class="relative"><i class="fa-solid fa-plane-up absolute left-5 top-5 text-stone-300"></i><input type="text" v-model="eventForm.flightNumber" placeholder="ä¾‹å¦‚ï¼šJX800, BR198" class="custom-input w-full rounded-2xl pl-12 pr-4 py-4 outline-none uppercase font-mono"></div>
                </div>
                <div>
                    <label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider flex justify-between items-center"><span>è¡Œç¨‹åœ°é» / é—œéµå­—</span></label>
                    <div class="relative"><input type="text" v-model="eventForm.location" :placeholder="locationPlaceholder" class="custom-input w-full rounded-2xl px-5 py-4 outline-none"></div>
                </div>
                <div><label class="block text-xs font-bold text-stone-400 mb-2 uppercase tracking-wider">å‚™è¨»</label><textarea v-model="eventForm.note" rows="3" class="custom-input w-full rounded-2xl px-5 py-4 outline-none" placeholder="è¼¸å…¥å‚™è¨»..."></textarea></div>
                <button @click="saveEvent" class="w-full bg-primary text-white font-bold py-4 rounded-2xl shadow-lg shadow-primary/20 hover:bg-primary-dark active:scale-95 transition mt-4 text-lg">ç¢ºèªå„²å­˜</button>
            </div>
        </div>
    </div>
    </transition>

</div>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            const today = new Date();
            const todayStr = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0') + '-' + String(today.getDate()).padStart(2, '0');

            return {
                isReadOnly: true,
                liffReady: false,
                liffError: false,
                currentView: 'itinerary',
                tripTitle: 'æ—¥æœ¬æ—…è¡Œ',
                startDate: todayStr, 
                days: [{}, {}, {}, {}, {}], 
                activeDayIndex: 0,
                itineraryEvents: [],
                loadingWeather: false,
                travelers: ['æˆ‘', 'æ—…ä¼´'],
                exchangeRate: 0.22,
                calcJpy: '',
                calcTwd: '',
                translationText: '',
                eventTypes: [
                    { value: 'activity', label: 'æ™¯é»', icon: 'fa-solid fa-map-pin' },
                    { value: 'food', label: 'ç¾é£Ÿ', icon: 'fa-solid fa-utensils' },
                    { value: 'flight', label: 'èˆªç­', icon: 'fa-solid fa-plane' },
                    { value: 'hotel', label: 'ä½å®¿', icon: 'fa-solid fa-bed' }
                ],
                cityKeywords: [
                    { key: 'æ±äº¬', val: 'æ±äº¬éƒ½' }, { key: 'æ–°å®¿', val: 'æ–°å®¿å€' }, { key: 'æ¾€è°·', val: 'æ¾€è°·å€' }, { key: 'æ¶‰è°·', val: 'æ¾€è°·å€' },
                    { key: 'æ± è¢‹', val: 'è±å³¶å€' }, { key: 'ä¸Šé‡', val: 'å°æ±å€' }, { key: 'æ·ºè‰', val: 'å°æ±å€' }, { key: 'éŠ€åº§', val: 'ä¸­å¤®å€' },
                    { key: 'ç§‹è‘‰åŸ', val: 'åƒä»£ç”°å€' }, { key: 'ç¯‰åœ°', val: 'ä¸­å¤®å€' }, { key: 'å°å ´', val: 'æ¸¯å€' }, { key: 'å…­æœ¬æœ¨', val: 'æ¸¯å€' },
                    { key: 'å¤§é˜ª', val: 'å¤§é˜ªå¸‚' }, { key: 'é›£æ³¢', val: 'å¤§é˜ªå¸‚' }, { key: 'æ¢…ç”°', val: 'å¤§é˜ªå¸‚' }, { key: 'å¿ƒé½‹æ©‹', val: 'å¤§é˜ªå¸‚' },
                    { key: 'é“é “å €', val: 'å¤§é˜ªå¸‚' }, { key: 'äº¬éƒ½', val: 'äº¬éƒ½å¸‚' }, { key: 'æ¸…æ°´å¯º', val: 'äº¬éƒ½å¸‚' }, { key: 'åµå±±', val: 'äº¬éƒ½å¸‚' },
                    { key: 'ç¥‡åœ’', val: 'äº¬éƒ½å¸‚' }, { key: 'ç¥æˆ¶', val: 'ç¥æˆ¶å¸‚' }, { key: 'å¥ˆè‰¯', val: 'å¥ˆè‰¯å¸‚' }, { key: 'ç¦å²¡', val: 'ç¦å²¡å¸‚' },
                    { key: 'åšå¤š', val: 'ç¦å²¡å¸‚' }, { key: 'å¤©ç¥', val: 'ç¦å²¡å¸‚' }, { key: 'æœ­å¹Œ', val: 'æœ­å¹Œå¸‚' }, { key: 'æ²–ç¹©', val: 'é‚£éœ¸å¸‚' },
                    { key: 'é‚£éœ¸', val: 'é‚£éœ¸å¸‚' }, { key: 'åå¤å±‹', val: 'åå¤å±‹å¸‚' }, { key: 'å‡½é¤¨', val: 'å‡½é¤¨å¸‚' }, { key: 'è¼•äº•æ¾¤', val: 'è¼•äº•æ¾¤ç”º' },
                    { key: 'ç®±æ ¹', val: 'ç®±æ ¹ç”º' }, { key: 'æ²³å£æ¹–', val: 'å¯Œå£«æ²³å£æ¹–ç”º' }, { key: 'å¯Œå£«å±±', val: 'å¯Œå£«å‰ç”°å¸‚' }, { key: 'è¿ªå£«å°¼', val: 'æµ¦å®‰å¸‚' },
                    { key: 'Disney', val: 'æµ¦å®‰å¸‚' }, { key: 'ç’°çƒå½±åŸ', val: 'å¤§é˜ªå¸‚' }, { key: 'USJ', val: 'å¤§é˜ªå¸‚' }, { key: 'æˆç”°', val: 'æˆç”°å¸‚' },
                    { key: 'ç¾½ç”°', val: 'å¤§ç”°å€' }, { key: 'é‡§è·¯', val: 'é‡§è·¯å¸‚' }, { key: 'å¹£èˆæ©‹', val: 'é‡§è·¯å¸‚' }, { key: 'é˜¿å¯’æ¹–', val: 'é‡§è·¯å¸‚' },
                    { key: 'æ‘©å‘¨æ¹–', val: 'å¼Ÿå­å±ˆç”º' }, { key: 'ç¶²èµ°', val: 'ç¶²èµ°å¸‚' }, { key: 'çŸ¥åºŠ', val: 'æ–œé‡Œç”º' }, { key: 'å¯Œè‰¯é‡', val: 'å¯Œè‰¯é‡å¸‚' },
                    { key: 'ç¾ç‘›', val: 'ç¾ç‘›ç”º' }, { key: 'æ—­å·', val: 'æ—­å·å¸‚' }, { key: 'å°æ¨½', val: 'å°æ¨½å¸‚' }, { key: 'ç™»åˆ¥', val: 'ç™»åˆ¥å¸‚' },
                    { key: 'æ´çˆºæ¹–', val: 'æ´çˆºæ¹–ç”º' }
                ],
                showEventModal: false,
                showSettingsModal: false,
                editingEventId: null,
                eventForm: { time: '10:00', location: '', note: '', type: 'activity', flightNumber: '' }
            }
        },
        computed: {
            currentDayEvents() {
                return this.itineraryEvents.filter(e => e && e.dayIndex === this.activeDayIndex).sort((a, b) => a.time.localeCompare(b.time));
            },
            currentDayData() {
                if (!this.days[this.activeDayIndex]) return {};
                return this.days[this.activeDayIndex];
            },
            locationPlaceholder() {
                if (!this.eventForm) return ''; 
                if (this.eventForm.type === 'hotel') return 'ä¾‹å¦‚ï¼šæ–°å®¿ç‹å­å¤§é£¯åº—';
                if (this.eventForm.type === 'flight') return 'ä¾‹å¦‚ï¼šTPE æ¡ƒåœ’æ©Ÿå ´';
                if (this.eventForm.type === 'activity') return 'ä¾‹å¦‚ï¼šæœ­å¹Œå¤§é€šå…¬åœ’';
                return 'ä¾‹å¦‚ï¼šæ–°å®¿ ç‡’è‚‰';
            }
        },
        mounted() {
            this.loadData();
            this.initLiff();
            setTimeout(() => { this.tryAutoWeather(this.activeDayIndex); }, 500);
        },
        watch: {
            itineraryEvents: { deep: true, handler: 'saveData' },
            exchangeRate: { handler: 'saveData' },
            days: { deep: true, handler: 'saveData' },
            tripTitle: { handler: 'saveData' },
            startDate: { handler: 'saveData' },
            travelers: { deep: true, handler: 'saveData' },
            activeDayIndex: {
                handler(newVal) { this.tryAutoWeather(newVal); }
            }
        },
        methods: {
            async initLiff() {
                try {
                    await liff.init({ liffId: '2008400942-wG0GRzGK' });
                    this.liffReady = true;
                    // If running in LINE App, allow edit immediately.
                    // If running on Web, wait for login.
                    if (liff.isInClient() || liff.isLoggedIn()) {
                        this.isReadOnly = false;
                        console.log('LIFF In-Client or Logged In -> Edit Mode Enabled');
                    } else {
                        // User needs to click "Login" button manually
                        this.isReadOnly = true;
                        console.log('LIFF Web but NOT Logged In -> Read Only');
                    }
                } catch (err) {
                    console.error('LIFF Init Failed', err);
                    this.liffError = true;
                    // Fallback for Google Sites iframe where LIFF init crashes due to domain mismatch
                    if (/Line/i.test(navigator.userAgent)) {
                        this.isReadOnly = false;
                    } else {
                        this.isReadOnly = true;
                    }
                }
            },
            manualUnlock() {
                const pass = prompt('è«‹è¼¸å…¥è§£é–å¯†ç¢¼ï¼š', '');
                if (pass === '1234') {
                    this.isReadOnly = false;
                    alert('ç·¨è¼¯æ¨¡å¼å·²è§£é–');
                } else if (pass !== null) {
                    alert('å¯†ç¢¼éŒ¯èª¤');
                }
            },
            tryAutoWeather(dayIndex) {
                const day = this.days[dayIndex];
                if (!day || (day.city && day.weather)) return;
                const events = this.itineraryEvents.filter(e => e && e.dayIndex === dayIndex && e.location && e.location.trim() !== '');
                if (events.length > 0) {
                    const mappedCity = this.resolveCityName(events[0].location);
                    if (day.city !== mappedCity) {
                        day.city = mappedCity;
                        this.saveData();
                        this.fetchWeatherForDay(dayIndex, true);
                    } else if (!day.weather) {
                        this.fetchWeatherForDay(dayIndex, true);
                    }
                }
            },
            resolveCityName(locationName) {
                for (const item of this.cityKeywords) {
                    if (locationName.includes(item.key)) return item.val;
                }
                return locationName; 
            },
            async setCityForDay() {
                const currentCity = this.days[this.activeDayIndex].city || '';
                const newCity = prompt('è«‹è¼¸å…¥é€™ä¸€å¤©æ‰€åœ¨çš„åŸå¸‚ (ä¾‹å¦‚ï¼šæ±äº¬ã€å¤§é˜ª)ï¼š', currentCity);
                if (newCity !== null && newCity.trim() !== '') {
                    if (!this.days[this.activeDayIndex]) this.days[this.activeDayIndex] = {};
                    const mapped = this.resolveCityName(newCity.trim());
                    this.days[this.activeDayIndex].city = mapped;
                    this.days[this.activeDayIndex].weather = null;
                    this.saveData();
                    await this.fetchWeatherForDay(this.activeDayIndex);
                }
            },
            async fetchWithRetry(url, retries = 2, delay = 500) {
                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(url);
                        if (!response.ok) throw new Error(`Status ${response.status}`);
                        return await response.json();
                    } catch (error) {
                        if (i === retries - 1) throw error;
                        await new Promise(res => setTimeout(res, delay));
                    }
                }
            },
            async fetchWeatherForDay(dayIndex, isSilent = false) {
                const day = this.days[dayIndex];
                if (!day || !day.city) return;
                this.loadingWeather = true;
                try {
                    const geoData = await this.fetchWithRetry(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(day.city)}&count=1&language=zh&format=json`);
                    if (geoData.results && geoData.results.length > 0) {
                        const { latitude, longitude } = geoData.results[0];
                        const weatherData = await this.fetchWithRetry(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true`);
                        if (weatherData.current_weather) {
                            day.weather = { temp: weatherData.current_weather.temperature, code: weatherData.current_weather.weathercode };
                            this.saveData();
                        }
                    } else if (!isSilent) {
                        alert("æ‰¾ä¸åˆ°è©²åŸå¸‚ï¼Œè«‹å˜—è©¦è¼¸å…¥ä¸»è¦åŸå¸‚åç¨± (å¦‚: æ±äº¬)ã€‚");
                    }
                } catch (e) {
                    console.log("Weather fetch error", e);
                } finally {
                    this.loadingWeather = false;
                }
            },
            getWeatherIcon(code) {
                if (code === 0) return 'â˜€ï¸';
                if (code <= 3) return 'â˜ï¸';
                if (code <= 48) return 'ğŸŒ«ï¸';
                if (code <= 67) return 'ğŸŒ§ï¸';
                if (code <= 77) return 'â„ï¸';
                if (code >= 95) return 'âš¡';
                return 'ğŸŒ¤ï¸';
            },
            getWeatherDescription(code) {
                if (code === 0) return 'æ™´æœ—';
                if (code <= 3) return 'å¤šé›²';
                if (code <= 48) return 'æœ‰éœ§';
                if (code <= 67) return 'æœ‰é›¨';
                if (code <= 77) return 'æœ‰é›ª';
                if (code >= 95) return 'é›·é›¨';
                return 'é™°å¤©';
            },
            getEventIcon(type) {
                const icons = { 'activity': 'fa-solid fa-location-dot', 'food': 'fa-solid fa-utensils', 'flight': 'fa-solid fa-plane', 'hotel': 'fa-solid fa-bed' };
                return icons[type] || 'fa-solid fa-circle';
            },
            getEventColor(type) {
                const colors = { 'activity': 'bg-primary text-white', 'food': 'bg-orange-400 text-white', 'flight': 'bg-indigo-500 text-white', 'hotel': 'bg-rose-400 text-white' };
                return colors[type] || 'bg-stone-300 text-white';
            },
            getDateDisplay(dayIndex, fullFormat = false) {
                if (!this.startDate) return fullFormat ? '' : `Day ${dayIndex + 1}`;
                const date = new Date(this.startDate);
                date.setDate(date.getDate() + dayIndex);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();
                const weekDays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
                const weekDay = weekDays[date.getDay()];
                if (fullFormat) return `${year}å¹´${month}æœˆ${day}æ—¥ (${weekDay})`;
                return `${month}/${day}`;
            },
            changeDuration(delta) {
                const currentLen = this.days.length;
                const newLen = currentLen + delta;
                if (newLen < 1) return;
                if (delta > 0) {
                    this.days.push({});
                } else {
                    const eventsInLastDay = this.itineraryEvents.filter(e => e.dayIndex === currentLen - 1);
                    if (eventsInLastDay.length > 0) {
                        if (!confirm(`ç¬¬ ${currentLen} å¤©é‚„æœ‰è¡Œç¨‹ï¼Œç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ`)) return;
                        this.itineraryEvents = this.itineraryEvents.filter(e => e.dayIndex !== currentLen - 1);
                    }
                    this.days.pop();
                    if (this.activeDayIndex >= newLen) this.activeDayIndex = newLen - 1;
                }
            },
            changeTravelerCount(delta) {
                const currentLen = this.travelers.length;
                const newLen = currentLen + delta;
                if (newLen < 1) return;
                if (delta > 0) {
                    this.travelers.push(`æ—…ä¼´ ${newLen}`);
                } else {
                    this.travelers.pop();
                }
            },
            saveTripSettings() {
                this.saveData();
                this.showSettingsModal = false;
            },
            calculate(source) {
                if (source === 'jpy') {
                    if (this.calcJpy === '' || this.calcJpy === null) {
                        this.calcTwd = '';
                    } else {
                        this.calcTwd = Math.round(this.calcJpy * this.exchangeRate * 10) / 10;
                    }
                } else if (source === 'twd') {
                    if (this.calcTwd === '' || this.calcTwd === null) {
                        this.calcJpy = '';
                    } else {
                        this.calcJpy = Math.round(this.calcTwd / this.exchangeRate);
                    }
                }
            },
            setJpy(amount) {
                this.calcJpy = amount;
                this.calculate('jpy');
            },
            quickAction() {
                if (this.currentView === 'converter') {
                    this.calcJpy = '';
                    this.calcTwd = '';
                } else {
                    this.openEventModal();
                }
            },
            openEventModal(event = null) {
                if (event) {
                    this.editingEventId = event.id;
                    this.eventForm = { ...event, type: event.type || 'activity', flightNumber: event.flightNumber || '' };
                } else {
                    this.editingEventId = null;
                    this.eventForm = { time: '10:00', location: '', note: '', type: 'activity', flightNumber: '' };
                }
                this.showEventModal = true;
            },
            saveEvent() {
                if (!this.eventForm.location) return alert('è«‹è¼¸å…¥åœ°é»');
                if (this.editingEventId) {
                    const idx = this.itineraryEvents.findIndex(e => e.id === this.editingEventId);
                    if (idx !== -1) {
                        this.itineraryEvents[idx] = { ...this.eventForm, id: this.editingEventId, dayIndex: this.activeDayIndex };
                    }
                } else {
                    this.itineraryEvents.push({ id: Date.now(), dayIndex: this.activeDayIndex, ...this.eventForm });
                }
                this.tryAutoWeather(this.activeDayIndex);
                this.showEventModal = false;
            },
            deleteEvent(id) {
                if (confirm('ç¢ºå®šåˆªé™¤æ­¤è¡Œç¨‹ï¼Ÿ')) {
                    this.itineraryEvents = this.itineraryEvents.filter(e => e.id !== id);
                    this.$nextTick(() => { this.tryAutoWeather(this.activeDayIndex); });
                }
            },
            getMapUrl(location) {
                return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`;
            },
            saveData() {
                localStorage.setItem('japanTripData', JSON.stringify({
                    tripTitle: this.tripTitle,
                    itineraryEvents: this.itineraryEvents,
                    exchangeRate: this.exchangeRate,
                    days: this.days,
                    startDate: this.startDate,
                    travelers: this.travelers
                }));
            },
            loadData() {
                const data = localStorage.getItem('japanTripData');
                const today = new Date();
                const todayStr = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0') + '-' + String(today.getDate()).padStart(2, '0');

                if (data) {
                    const parsed = JSON.parse(data);
                    this.tripTitle = parsed.tripTitle || 'æ—¥æœ¬æ—…è¡Œ';
                    this.itineraryEvents = parsed.itineraryEvents || [];
                    this.exchangeRate = parsed.exchangeRate || 0.22;
                    this.days = (parsed.days || [{}, {}, {}, {}, {}]).map(d => ({ ...d })); 
                    this.startDate = parsed.startDate || todayStr;
                    this.travelers = parsed.travelers || ['æˆ‘', 'æ—…ä¼´'];
                } else {
                    this.tripTitle = 'æ—¥æœ¬æ—…è¡Œ';
                    this.days = [{}, {}, {}, {}, {}];
                    this.startDate = todayStr;
                    this.itineraryEvents = [
                        { id: 1, dayIndex: 0, time: '10:00', location: 'æˆç”°æ©Ÿå ´', note: 'é ˜å– JR Pass / è¥¿ç“œå¡', type: 'flight', flightNumber: 'JX800' },
                        { id: 2, dayIndex: 0, time: '12:30', location: 'æ–°å®¿ç‹å­å¤§é£¯åº—', note: '', type: 'hotel' },
                        { id: 3, dayIndex: 0, time: '14:00', location: 'ä¸€è˜­ æ–°å®¿ä¸­å¤®æ±å£åº—', note: '', type: 'food' }
                    ];
                }
            },
            resetDataConfirm() {
                if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è³‡æ–™é‡ç½®å—ï¼Ÿ')) {
                    localStorage.removeItem('japanTripData');
                    location.reload();
                }
            }
        }
    }).mount('#app');
</script>
</body>
</html>
